<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Remote PR Info (test-user)</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <style>
    /* Tree view styling based on https://iamkate.com/code/tree-views/ */
/* Shared CSS for tree navigation across all dashboards */

.tree {
    --spacing: 1.3rem;
    --radius: 8px;
    font-size: 14px;
    color: #24292f;
    line-height: var(--spacing);
    list-style: none;
    padding-left: 0;
}

.tree li {
    display: block;
    position: relative;
    padding-left: calc(2 * var(--spacing) - var(--radius) - 2px);
    min-height: var(--spacing);
    margin-bottom: 2px;
}

.tree ul {
    margin-left: calc(var(--radius) - var(--spacing));
    padding-left: 0;
    list-style: none;
}

.tree ul li {
    border-left: 2px solid #ddd;
}

.tree ul li:last-child {
    border-color: transparent;
}

.tree ul li::before {
    content: '';
    display: block;
    position: absolute;
    top: calc(var(--spacing) / -2);
    left: -2px;
    width: calc(var(--spacing) + 2px);
    height: calc(var(--spacing) - 2px);
    border: solid #ddd;
    border-width: 0 0 2px 2px;
}

.tree summary {
    display: block;
    cursor: pointer;
    line-height: var(--spacing);
    min-height: var(--spacing);
    margin-bottom: 2px;
}

.tree summary::marker,
.tree summary::-webkit-details-marker {
    display: none;
}

.tree summary:focus {
    outline: none;
}

.tree summary:focus-visible {
    outline: 1px dotted #000;
}

/* Base circle positioning - applies to both gray (li::after) and blue (summary::before) circles.
   Keep the 'top' value in sync for both so they align vertically. */
.tree li::after,
.tree summary::before {
    content: '';
    display: block;
    position: absolute;
    top: calc(var(--spacing) / 2 - var(--radius) - 2px);
    left: calc(var(--spacing) - var(--radius) - 1px);
    width: calc(2 * var(--radius));
    height: calc(2 * var(--radius));
    border-radius: 50%;
    background: transparent;
}

.tree summary::before {
    z-index: 1;
    background: #4a90e2;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 10px;
    content: '‚ñ∂';
}

.tree details[open] > summary::before {
    content: '‚ñº';
}

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
      margin: 10px;
      line-height: 1.3;
      background-color: #f6f8fa;
      font-size: 13px;
      color: #24292f;
    }
    .header {
      /* NVIDIA brand green (keep readable white text/links on top). */
      background-color: #76b900;
      color: white;
      padding: 10px 15px;
      border-radius: 4px;
      /* Keep pages visually tight: legend/content should sit close to the header. */
      margin-bottom: 4px;
    }
    .header a {
      color: #ffffff;
      text-decoration: none;
    }
    .header a:hover {
      text-decoration: underline;
    }
    .header h1 {
      margin: 0;
      font-size: 18px;
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 12px;
    }
    .header .header-meta {
      font-size: 12px;
      font-weight: 500;
      opacity: 0.95;
      white-space: nowrap;
    }

    /* Subtitle text in the header (keep high contrast against NVIDIA green). */
    .header .header-subtitle {
      margin: 5px 0 0 0;
      opacity: 1;
      color: #ffffff;
    }
    .header .header-subtitle .meta {
      opacity: 0.95;
      font-size: 12px;
    }
    .header .page-age {
      display: inline-block;
      margin-left: 6px;
      padding: 1px 8px;
      border-radius: 999px;
      /* Subtle chip: enough contrast on NVIDIA green without looking ‚Äúloud‚Äù. */
      background: rgba(0, 0, 0, 0.16);
      color: #ffffff;
      font-weight: 600;
      font-size: 12px;
      line-height: 1.3;
      white-space: nowrap;
    }

    .footer {
      margin-top: 12px;
      padding: 10px 0;
      color: #24292f;
    }
    .footer details summary {
      cursor: pointer;
      user-select: none;
      /* Make "Legend & Help" less conspicuous per UX request. */
      font-weight: 600;
      font-size: 12px;
      color: #57606a;
    }
    .footer details summary:hover {
      color: #0969da;
    }
    .footer details {
      color: #57606a;
      font-size: 12px;
    }

    /* Legend/Help blocks embedded near the top of dashboards (not the footer). */
    .legend details summary {
      cursor: pointer;
      user-select: none;
      font-weight: 600;
      font-size: 12px;
      color: #57606a;
    }
    .legend details {
      color: #57606a;
      font-size: 12px;
    }
    .stats-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 12px;
    }
    .stats-table td {
      padding: 6px 8px;
      border-top: 1px solid #d8dee4;
      vertical-align: top;
    }
    .stats-table td.k {
      width: 220px;
      color: #57606a;
      font-weight: 600;
      white-space: nowrap;
    }
    .stats-table td.v {
      color: #24292f;
      font-family: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;
      word-break: break-word;
    }
    .stats-table td.section {
      padding: 10px 8px 6px 8px;
      color: #24292f;
      font-weight: 700;
      background: #f6f8fa;
      border-top: 1px solid #d8dee4;
    }
    .stats-pre {
      margin: 0;
      white-space: pre-wrap;
      overflow-wrap: anywhere;
      word-break: break-word;
      font-family: ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace;
      font-size: 12px;
      line-height: 1.35;
    }

    
    .header a { color: #ffffff; text-decoration: none; }
    .header a:hover { text-decoration: underline; }
    .timestamp { margin: 5px 0 0 0; opacity: 0.9; font-size: 12px; }
    pre {
      background-color: #ffffff;
      border: 1px solid #d0d7de;
      border-radius: 4px;
      padding: 12px;
      /* Avoid nested scrollbars when expanding triangles; let the page scroll instead. */
      overflow: visible;
      /* Wrap long lines so we don't introduce horizontal scrollbars on expansion. */
      white-space: pre-wrap;
      overflow-wrap: anywhere;
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 13px;
      line-height: 1;
      margin: 0;
    }
    a { color: #0969da; text-decoration: none; }
    a:hover { text-decoration: underline; }
    .repo-name { font-weight: bold; margin-top: 10px; }
    .current { font-weight: bold; }
    .merged-branch { color: #999999; }
    .closed-branch { 
      background-color: #24292f; 
      color: #ffffff; 
      padding: 2px 6px; 
      border-radius: 3px; 
      font-weight: 600;
    }
    .indent { margin-left: 20px; }
    .error { color: #c83a3a; }

    /* Status indicator pill (same look as show_commit_history.j2) */
    .status-indicator {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      margin-right: 6px;
      vertical-align: middle;
      font-size: 10px;
      font-weight: 600;
      color: white;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      border: 1px solid transparent;
    }
    .status-success { background-color: #2da44e; border-color: #1f7a37; }
    .status-failed { background-color: #c83a3a; border-color: #a83232; }
    .status-warning { background-color: #8c959f; border-color: #6e7781; }
    .status-building { background-color: #bf8700; border-color: #9a6a00; } /* RUNNING */
    .status-unknown { background-color: #8c959f; border-color: #6e7781; }


    /* GitHub checks tooltip styling (static; shared across dashboards) */
    .gh-status-tooltip {
      position: relative;
      display: inline-block;
    }
    .gh-status-tooltip .tooltiptext {
      visibility: hidden;
      max-width: calc(100vw - 40px);
      background-color: #24292f;
      color: #ffffff;
      text-align: left;
      border-radius: 6px;
      padding: 8px 12px;
      position: fixed;
      z-index: 1000;
      left: 20px;
      right: 20px;
      width: auto;
      opacity: 0;
      transition: opacity 0.3s, visibility 0s 1s;
      font-size: 12px;
      line-height: 1.5;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      white-space: normal;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    .gh-status-tooltip .tooltiptext::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 20px;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #24292f transparent transparent transparent;
    }
    .gh-status-tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
      transition-delay: 1s;
    }

    /* Auto-refresh connection banner (sleep/wake fault tolerance) */
    .auto-refresh-banner {
      position: fixed;
      left: 10px;
      right: 10px;
      bottom: 10px;
      z-index: 9999;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #d0d7de;
      background: rgba(255, 255, 255, 0.96);
      color: #24292f;
      box-shadow: 0 4px 12px rgba(0,0,0,0.12);
      font-size: 12px;
      display: none;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    .auto-refresh-banner .msg {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .auto-refresh-banner button {
      border: 1px solid #d0d7de;
      background: #f6f8fa;
      color: #24292f;
      border-radius: 8px;
      padding: 4px 10px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 600;
      white-space: nowrap;
    }
    .auto-refresh-banner button:hover {
      background: #eef1f4;
    }
  </style>

  
</head>
<body>
  <div class="header">
    <h1>
<span>Remote PR Info (test-user)</span>
<span class="header-meta">Page generated: 2026-01-11 18:35:32 PST <span id="page-age" class="page-age"></span></span></h1></div>
<!-- Legend/Help Section (keep consistent with commit history) -->
  <div class="container legend" style="margin-bottom: 0px; padding: 12px; background-color: #f6f8fa;">
    <details data-url-state="1" data-url-key="legend">
      <summary>
        <span style="display: inline-flex; align-items: center; justify-content: space-between; gap: 10px; width: calc(100% - 18px);">
          <span style="flex: 1 1 auto;">Legend &amp; Help</span>
          <button type="button"
                  onclick="event.preventDefault(); event.stopPropagation(); try { DashboardUrlState.resetView({reload: false}); } catch (e) {}"
                  style="flex: 0 0 auto; padding: 2px 8px; font-size: 11px; line-height: 1.2; background: transparent; color: #57606a; border: 1px solid #d0d7de; border-radius: 999px; cursor: pointer;"
                  title="Reset view (clears URL params and restores defaults)">
            Reset view
          </button>
        </span>
      </summary>
      <div style="margin-top: 10px; font-size: 12px; line-height: 1.55;">
        <div style="margin-bottom: 12px;">
          <div style="font-weight: 600; margin-bottom: 6px; color: #24292f;">CI Status Symbols:</div>
          <ul style="margin: 4px 0; padding-left: 20px;">
            <li><span style="color: #2da44e; display: inline-flex; vertical-align: text-bottom;"><svg aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="12" height="12" data-view-component="true" class="octicon octicon-check-circle-fill" fill="currentColor"><path fill-rule="evenodd" d="M8 16A8 8 0 108 0a8 8 0 000 16zm3.78-9.78a.75.75 0 00-1.06-1.06L7 9.94 5.28 8.22a.75.75 0 10-1.06 1.06l2 2a.75.75 0 001.06 0l4-4z"></path></svg></span> / <span style="color: #2da44e; font-weight: 900;">‚úì</span> - Passed (required/optional)</li>
            <li><span style="display: inline-flex; align-items: center; justify-content: center; width: 12px; height: 12px; border-radius: 999px; background-color: #c83a3a; color: #ffffff; font-size: 10px; font-weight: 900; line-height: 1;">‚úó</span> / <span style="color: #c83a3a; font-weight: 900;">‚úó</span> - Failed (required/optional)</li>
            <li><span style="color: #8c959f;">‚è≥</span> - In progress</li>
            <li><span style="display: inline-flex; align-items: center; justify-content: center; width: 12px; height: 12px; border-radius: 999px; background-color: #8c959f; color: #ffffff; font-size: 10px; font-weight: 900; line-height: 1;">‚Ä¢</span> - Pending</li>
            <li><span style="display: inline-flex; align-items: center; justify-content: center; width: 12px; height: 12px; border-radius: 999px; background-color: #8c959f; color: #ffffff; font-size: 10px; font-weight: 900; line-height: 1;">√ó</span> - Canceled</li>
            <li><span style="color: #8c959f; display: inline-flex; vertical-align: text-bottom;"><svg aria-hidden="true" viewBox="0 0 16 16" version="1.1" width="12" height="12" data-view-component="true" class="octicon octicon-circle-slash" fill="currentColor"><path fill-rule="evenodd" d="M8 16A8 8 0 108 0a8 8 0 000 16ZM1.5 8a6.5 6.5 0 0110.364-5.083l-8.947 8.947A6.473 6.473 0 011.5 8Zm3.136 5.083 8.947-8.947A6.5 6.5 0 014.636 13.083Z"></path></svg></span> - Skipped</li>
            <li><span style="display: inline-flex; align-items: center; justify-content: center; width: 12px; height: 12px; color: #8c959f; font-size: 12px; font-weight: 900;">‚óá</span> - Expected check (not yet returned by API)</li>
          </ul>
        </div>

        <div style="margin-bottom: 12px;">
          <div style="font-weight: 600; margin-bottom: 6px; color: #24292f;">Badges:</div>
          <ul style="margin: 4px 0; padding-left: 20px;">
            <li><span style="color: #c83a3a; font-weight: 700;">[REQUIRED]</span> - This check must pass for PR to be merged</li>
            <li><span style="color: #57606a; font-weight: 400;">[may be REQUIRED]</span> - Known required check not marked as required by API (cache/timing issue)</li>
          </ul>
        </div>

        <div style="margin-bottom: 12px;">
          <div style="font-weight: 600; margin-bottom: 6px; color: #24292f;">Job Steps:</div>
          <ul style="margin: 4px 0; padding-left: 20px;">
            <li><strong>Build and Test - dynamo</strong> shows phase breakdown (Build Image, Rust checks, pytest...)</li>
            <li><strong>Long-running jobs</strong> (‚â•10 min) show steps with duration ‚â•30s</li>
            <li><strong>Required jobs</strong> always show failing steps</li>
          </ul>
        </div>

        <div style="margin-bottom: 6px;">
          <div style="font-weight: 600; margin-bottom: 6px; color: #24292f;">Links:</div>
          <ul style="margin: 4px 0; padding-left: 20px;">
            <li><strong>[log]</strong> - GitHub Actions job page</li>
            <li><strong>[cached raw log]</strong> - Locally cached log for snippets</li>
          </ul>
        </div>
      </div>
    </details>
  </div>
  
    
      <ul class="tree">
<li>
<details open id="tree_children_k_95a7df7c30">
<summary>
<a href="https://github.com/test-user" target="_blank" style="color: #0969da; text-decoration: none; font-weight: 600;">test-user</a> <span style="color: #666; font-size: 12px;">(ai-dynamo/dynamo)</span></summary>
<ul>
<li>
<details open id="tree_children_k_8f9f513aa2" data-parent-children-id="tree_children_k_95a7df7c30" data-url-key="t.1236200">
<summary>
<button data-clipboard-text="feature/ci-matrix-expansion" onclick="copyFromClipboardAttr(this)" style="padding: 1px 4px; font-size: 10px; line-height: 1; background-color: transparent; color: #57606a; border: 1px solid #d0d7de; border-radius: 5px; cursor: pointer; display: inline-flex; align-items: center; vertical-align: baseline; margin-right: 4px;" title="Copy branch name: feature/ci-matrix-expansion" onmouseover="this.style.backgroundColor='#f3f4f6'; this.style.borderColor='#8c959f';" onmouseout="this.style.backgroundColor='transparent'; this.style.borderColor='#d0d7de';"><svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor" style="display: inline-block; vertical-align: middle;"><path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path>
<path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path></svg></button> ai-dynamo/feature/ci-matrix-expansion <a href="https://github.com/ai-dynamo/dynamo/commit/2c1892d386311d42fa731893d2be183b1b5bc5d4" style="color: #0969da; font-size: 12px; text-decoration: none;" title="feat: Add matrix expansion support for CI workflows">[2c1892d]</a></summary>
<ul>
<li class="leaf">
<span style="color: #1f2328;">feat: Add matrix expansion support for CI workflows</span></li>
<li class="leaf">
(<span style="color: #656d76; font-size: 12px;">modified: 2026-01-11 17:35 PT</span>, <span style="color: #656d76; font-size: 12px;">age: 1h</span>)</li>
<li>
<details id="tree_children_k_73f75e3414" data-parent-children-id="tree_children_k_8f9f513aa2" data-url-key="t.remote.2c1892d">
<summary>
CI: ‚è≥ pending, Review: ‚úÖ Approved</summary>
<ul>
<li class="leaf">
<span style="color: #2da44e; font-weight: 900;">‚úì</span> <span style="font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace; font-size: 12px;">mock-success</span><span style="color: #57606a; font-size: 12px;"> ‚Äî Mock CI Check (success)</span><span style="color: #57606a; font-size: 12px;"> (2m 34s)</span></li>
<li class="leaf">
<span style="display: inline-flex; align-items: center; justify-content: center; width: 12px; height: 12px; border-radius: 999px; background-color: #8c959f; color: #ffffff; font-size: 10px; font-weight: 900; line-height: 1;">‚Ä¢</span> <span style="font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace; font-size: 12px;">mock-pending</span><span style="color: #57606a; font-size: 12px;"> ‚Äî Mock CI Check (pending)</span></li>
<li class="leaf">
<span style="color: #c83a3a; font-weight: 900;">‚úó</span> <span style="font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace; font-size: 12px;">mock-failure</span><span style="color: #57606a; font-size: 12px;"> ‚Äî Mock CI Check (failure)</span><span style="color: #57606a; font-size: 12px;"> (5m 12s)</span></li>
</ul>
</details>
</li>
</ul>
</details>
</li>
<li>
<details open id="tree_children_k_c6456fe767" data-parent-children-id="tree_children_k_95a7df7c30" data-url-key="t.1236200">
<summary>
<button data-clipboard-text="bugfix/backend-hierarchy" onclick="copyFromClipboardAttr(this)" style="padding: 1px 4px; font-size: 10px; line-height: 1; background-color: transparent; color: #57606a; border: 1px solid #d0d7de; border-radius: 5px; cursor: pointer; display: inline-flex; align-items: center; vertical-align: baseline; margin-right: 4px;" title="Copy branch name: bugfix/backend-hierarchy" onmouseover="this.style.backgroundColor='#f3f4f6'; this.style.borderColor='#8c959f';" onmouseout="this.style.backgroundColor='transparent'; this.style.borderColor='#d0d7de';"><svg width="12" height="12" viewBox="0 0 16 16" fill="currentColor" style="display: inline-block; vertical-align: middle;"><path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path>
<path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path></svg></button> ai-dynamo/bugfix/backend-hierarchy <a href="https://github.com/ai-dynamo/dynamo/commit/7b0269b5dd8b8b04bc6472c752cc2412579f99f4" style="color: #0969da; font-size: 12px; text-decoration: none;" title="fix: Update backend status check hierarchy">[7b0269b]</a></summary>
<ul>
<li class="leaf">
<span style="color: #1f2328;">fix: Update backend status check hierarchy</span></li>
<li class="leaf">
(<span style="color: #656d76; font-size: 12px;">modified: 2026-01-11 16:35 PT</span>, <span style="color: #656d76; font-size: 12px;">age: 2h</span>)</li>
<li>
<details id="tree_children_k_177450e549" data-parent-children-id="tree_children_k_c6456fe767" data-url-key="t.remote.7b0269b">
<summary>
CI: ‚è≥ success, üí¨ Unresolved: 2</summary>
<ul>
<li class="leaf">
<span style="color: #2da44e; font-weight: 900;">‚úì</span> <span style="font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace; font-size: 12px;">mock-success</span><span style="color: #57606a; font-size: 12px;"> ‚Äî Mock CI Check (success)</span><span style="color: #57606a; font-size: 12px;"> (2m 34s)</span></li>
<li class="leaf">
<span style="display: inline-flex; align-items: center; justify-content: center; width: 12px; height: 12px; border-radius: 999px; background-color: #8c959f; color: #ffffff; font-size: 10px; font-weight: 900; line-height: 1;">‚Ä¢</span> <span style="font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace; font-size: 12px;">mock-pending</span><span style="color: #57606a; font-size: 12px;"> ‚Äî Mock CI Check (pending)</span></li>
<li class="leaf">
<span style="color: #c83a3a; font-weight: 900;">‚úó</span> <span style="font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace; font-size: 12px;">mock-failure</span><span style="color: #57606a; font-size: 12px;"> ‚Äî Mock CI Check (failure)</span><span style="color: #57606a; font-size: 12px;"> (5m 12s)</span></li>
</ul>
</details>
</li>
</ul>
</details>
</li>
</ul>
</details>
</li>
</ul>
    
  

  <div class="footer">
    <details data-url-state="1" data-url-key="stats">
      <summary>Statistics</summary>
      <table class="stats-table">
        
        <tr>
          
          <td class="k">Generation time</td>
          <td class="v">
            
            0.00s
            
          </td>
          
        </tr>
        
        <tr>
          
          <td class="k">Repo</td>
          <td class="v">
            
            ai-dynamo/dynamo
            
          </td>
          
        </tr>
        
        <tr>
          
          <td class="k">GitHub user</td>
          <td class="v">
            
            test-user
            
          </td>
          
        </tr>
        
        <tr>
          
          <td class="k">PRs shown</td>
          <td class="v">
            
            2
            
          </td>
          
        </tr>
        
        <tr>
          
          <td class="section" colspan="2">GitHub API</td>
          
        </tr>
        
        <tr>
          
          <td class="k">Budget &amp; mode</td>
          <td class="v">
            
            <pre class="stats-pre">mode: normal
max_github_api_calls: 100
budget_max: 100
budget_exhausted: false
core_remaining: 4135/5000
core_resets: 2026-01-11 18:46:22 PST</pre>
            
          </td>
          
        </tr>
        
        <tr>
          
          <td class="k">REST summary</td>
          <td class="v">
            
            <pre class="stats-pre">calls: 1
ok: 1
errors: 0
time_total: 0.21s</pre>
            
          </td>
          
        </tr>
        
        <tr>
          
          <td class="k">REST by category (top 15)</td>
          <td class="v">
            
            <pre class="stats-pre">category    calls   time
rate_limit      1    0.21s</pre>
            
          </td>
          
        </tr>
        
        <tr>
          
          <td class="k">REST errors by status</td>
          <td class="v">
            
            (none)
            
          </td>
          
        </tr>
        
        <tr>
          
          <td class="k">REST errors by category+status</td>
          <td class="v">
            
            (none)
            
          </td>
          
        </tr>
        
        <tr>
          
          <td class="k">Cache summary</td>
          <td class="v">
            
            <pre class="stats-pre">hits: 0
misses: 0
writes_ops: 0
writes_entries: 0</pre>
            
          </td>
          
        </tr>
        
      </table>
    </details>
  </div>
  

  <script>
  // Position tooltips dynamically (static; shared)
  document.addEventListener('DOMContentLoaded', function() {
    var tooltips = document.querySelectorAll('.gh-status-tooltip');
    tooltips.forEach(function(tooltip) {
      tooltip.addEventListener('mouseenter', function() {
        var tooltipText = this.querySelector('.tooltiptext');
        if (!tooltipText) return;
        var rect = this.getBoundingClientRect();
        // Position tooltip above the element
        tooltipText.style.top = (rect.top - tooltipText.offsetHeight - 10) + 'px';
      });
    });
  });

  // Shared tree toggle JS (static; used by <pre>-tree output)
  function toggleTreeChildren(childrenId, toggleEl) {
    var el = document.getElementById(childrenId);
    if (!el) return;
    var hidden = (el.style.display === 'none' || el.style.display === '');
    el.style.display = hidden ? 'inline' : 'none';
    if (toggleEl) {
      toggleEl.textContent = hidden ? '‚ñº' : '‚ñ∂';
    }
    try {
      if (window.DashboardUrlState && typeof window.DashboardUrlState.setBool === 'function') {
        var defExp = false;
        try { defExp = (toggleEl && toggleEl.getAttribute('data-default-expanded') === '1'); } catch (e) {}
        var urlKey = '';
        try { urlKey = String((toggleEl && toggleEl.getAttribute('data-url-key')) || ''); } catch (e) { urlKey = ''; }
        if (!urlKey) {
          urlKey = 't.' + String(childrenId || '');
        }
        if (typeof window.DashboardUrlState.setBoolDefault === 'function') {
          window.DashboardUrlState.setBoolDefault(urlKey, hidden, defExp);
        } else {
          window.DashboardUrlState.setBool(urlKey, hidden);
        }
      }
    } catch (e) {}
  }

  // Shared "Snippet" toggle (used by [raw log] leaves)
  function toggleErrorSnippet(errorId, toggleEl) {
    var el = document.getElementById(errorId);
    if (!el) return;
    var hidden = (el.style.display === 'none' || el.style.display === '');
    el.style.display = hidden ? 'inline' : 'none';
    if (toggleEl) {
      toggleEl.textContent = hidden ? '‚ñº Hide snippet' : '‚ñ∂ Snippet';
    }
    try {
      if (window.DashboardUrlState && typeof window.DashboardUrlState.setBool === 'function') {
        var defExp = false;
        try { defExp = (toggleEl && toggleEl.getAttribute('data-default-expanded') === '1'); } catch (e) {}
        var urlKey = '';
        try { urlKey = String((toggleEl && toggleEl.getAttribute('data-url-key')) || ''); } catch (e) { urlKey = ''; }
        if (!urlKey) {
          urlKey = 's.' + String(errorId || '');
        }
        if (typeof window.DashboardUrlState.setBoolDefault === 'function') {
          window.DashboardUrlState.setBoolDefault(urlKey, hidden, defExp);
        } else {
          window.DashboardUrlState.setBool(urlKey, hidden);
        }
      }
    } catch (e) {}
  }

  // Collapse snippet from the in-snippet "X" button (also resets toggle triangle + URL state).
  function collapseErrorSnippet(errorId) {
    var el = document.getElementById(errorId);
    if (!el) return;
    el.style.display = 'none';

    var toggleEl = document.getElementById(String(errorId || '') + '__toggle');
    if (!toggleEl) {
      try { toggleEl = document.querySelector('[data-error-id=\"' + String(errorId || '') + '\"]'); } catch (e) {}
    }
    if (toggleEl) {
      toggleEl.textContent = '‚ñ∂ Snippet';
    }

    try {
      if (window.DashboardUrlState && typeof window.DashboardUrlState.setBool === 'function') {
        var defExp = false;
        try { defExp = (toggleEl && toggleEl.getAttribute('data-default-expanded') === '1'); } catch (e) {}
        var urlKey = '';
        try { urlKey = String((toggleEl && toggleEl.getAttribute('data-url-key')) || ''); } catch (e) { urlKey = ''; }
        if (!urlKey) {
          urlKey = 's.' + String(errorId || '');
        }
        if (typeof window.DashboardUrlState.setBoolDefault === 'function') {
          window.DashboardUrlState.setBoolDefault(urlKey, false, defExp);
        } else {
          window.DashboardUrlState.setBool(urlKey, false);
        }
      }
    } catch (e) {}
  }

  // Shared copy-to-clipboard helpers
  function copyToClipboard(text, button) {
    if (!text) return;
    var textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.position = 'fixed';
    textArea.style.left = '-999999px';
    textArea.style.top = '-999999px';
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();

    try {
      var successful = document.execCommand('copy');
      document.body.removeChild(textArea);
      if (successful && button) {
        var originalHTML = button.innerHTML;
        // copy_icon_svg is HTML and may contain newlines/quotes; encode as JSON to avoid breaking JS parsing.
        var icon = "\u003csvg width=\"12\" height=\"12\" viewBox=\"0 0 16 16\" fill=\"currentColor\" style=\"display: inline-block; vertical-align: middle;\"\u003e\u003cpath d=\"M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z\"\u003e\u003c/path\u003e\u003c/svg\u003e";
        button.innerHTML = (icon ? icon : '') + '<span style="margin-left: 6px;">Copied!</span>';
        setTimeout(function() { button.innerHTML = originalHTML; }, 2000);
      }
    } catch (err) {
      document.body.removeChild(textArea);
    }
  }

  function copyFromClipboardAttr(button) {
    if (!button) return;
    var text = button.getAttribute('data-clipboard-text');
    if (!text) return;
    copyToClipboard(text, button);
  }

  // Calculate and display page age (shared)
  (function() {
    var el = document.getElementById('page-age');
    if (!el) return;
    const timeStr = '2026-01-11 18:35:32 PST';
    const timeStrFixed = timeStr.replace(' PST', '-08:00').replace(' PDT', '-07:00');
    const generatedTime = new Date(timeStrFixed);

    function updatePageAge() {
      if (isNaN(generatedTime.getTime())) {
        el.textContent = '(invalid date)';
        return;
      }
      const now = new Date();
      const ageMs = now - generatedTime;
      const seconds = Math.floor(ageMs / 1000);
      const minutes = Math.floor(seconds / 60);
      const hours = Math.floor(minutes / 60);
      const days = Math.floor(hours / 24);

      let ageText = '';
      if (days > 0) {
        ageText = `(${days} day${days > 1 ? 's' : ''} ${hours % 24} hour${(hours % 24) !== 1 ? 's' : ''} old)`;
      } else if (hours > 0) {
        ageText = `(${hours} hour${hours > 1 ? 's' : ''} ${minutes % 60} min old)`;
      } else if (minutes > 0) {
        ageText = `(${minutes} minute${minutes > 1 ? 's' : ''} old)`;
      } else {
        ageText = `(${seconds} second${seconds !== 1 ? 's' : ''} old)`;
      }

      el.textContent = ageText;
    }

    updatePageAge();
    setInterval(updatePageAge, 3000);
  })();

  // ====================================================================================
  // URL <-> UI state sync (shared)
  //
  // Goal: allow cut/paste of dashboard URLs that preserve view state:
  // - checkboxes / selects / <details> that opt-in via `data-url-state="1"`
  // - tree expansions/snippets via toggleTreeChildren()/toggleErrorSnippet()
  //
  // Storage:
  // - querystring (`?key=value`) using history.replaceState (no reload)
  // - also supports reading state from hash (`#key=value&...`) for convenience/back-compat
  // ====================================================================================
  (function() {
    function _parseParams() {
      var out = new URLSearchParams();
      try {
        var qs = new URLSearchParams(window.location.search || '');
        qs.forEach(function(v, k) { out.set(k, v); });
      } catch (e) {}
      try {
        var h = String(window.location.hash || '');
        if (h && h.indexOf('=') !== -1) {
          var hs = h.startsWith('#') ? h.slice(1) : h;
          var hp = new URLSearchParams(hs);
          hp.forEach(function(v, k) {
            if (!out.has(k)) out.set(k, v);
          });
        }
      } catch (e) {}
      return out;
    }

    function _isTruthyParam(v) {
      var s = String(v || '').trim().toLowerCase();
      return (s === '1' || s === 'true' || s === 'yes' || s === 'on' || s === 'open');
    }

    function _controlKey(el) {
      if (!el) return '';
      var k = el.getAttribute('data-url-key');
      if (k) return String(k);
      if (el.id) return String(el.id);
      var nm = el.getAttribute('name');
      if (nm) return String(nm);
      return '';
    }

    function _replaceUrl(params) {
      try {
        var url = new URL(window.location.href);
        // Preserve any existing non-state hash (anchors). If hash looks like state, prefer empty hash.
        var keepHash = '';
        var h = String(url.hash || '');
        if (h && h.indexOf('=') === -1) keepHash = h;
        url.search = params.toString() ? ('?' + params.toString()) : '';
        url.hash = keepHash;
        window.history.replaceState({}, '', url.toString());
      } catch (e) {}
    }

    var _defaults = {};
    var _restoring = false;

    function _captureDefaults() {
      var nodes = document.querySelectorAll('[data-url-state="1"]');
      nodes.forEach(function(el) {
        var key = _controlKey(el);
        if (!key) return;
        if (el.tagName && el.tagName.toLowerCase() === 'details') {
          _defaults[key] = el.open ? '1' : '0';
          return;
        }
        if (el.tagName && el.tagName.toLowerCase() === 'select') {
          _defaults[key] = String(el.value || '');
          return;
        }
        var t = (el.getAttribute('type') || '').toLowerCase();
        if (t === 'checkbox') {
          _defaults[key] = el.checked ? '1' : '0';
          return;
        }
      });
    }

    function _applyToControlsFromParams(params) {
      var nodes = document.querySelectorAll('[data-url-state="1"]');
      _restoring = true;
      try {
        nodes.forEach(function(el) {
          var key = _controlKey(el);
          if (!key) return;
          if (!params.has(key)) return;
          var v = params.get(key);
          if (el.tagName && el.tagName.toLowerCase() === 'details') {
            el.open = _isTruthyParam(v);
            // 'toggle' event is not reliably fired by setting `open` in all browsers; dispatch one.
            try { el.dispatchEvent(new Event('toggle')); } catch (e) {}
            return;
          }
          if (el.tagName && el.tagName.toLowerCase() === 'select') {
            el.value = String(v || '');
            try { el.dispatchEvent(new Event('change')); } catch (e) {}
            return;
          }
          var t = (el.getAttribute('type') || '').toLowerCase();
          if (t === 'checkbox') {
            el.checked = _isTruthyParam(v);
            try { el.dispatchEvent(new Event('change')); } catch (e) {}
            return;
          }
        });
      } finally {
        _restoring = false;
      }
    }

    function _bindControlsToUrl() {
      var nodes = document.querySelectorAll('[data-url-state="1"]');
      nodes.forEach(function(el) {
        var key = _controlKey(el);
        if (!key) return;
        var evt = 'change';
        if (el.tagName && el.tagName.toLowerCase() === 'details') evt = 'toggle';
        el.addEventListener(evt, function() {
          if (_restoring) return;
          var params = _parseParams();
          var val = '';
          if (el.tagName && el.tagName.toLowerCase() === 'details') {
            val = el.open ? '1' : '0';
          } else if (el.tagName && el.tagName.toLowerCase() === 'select') {
            val = String(el.value || '');
          } else {
            var t = (el.getAttribute('type') || '').toLowerCase();
            if (t === 'checkbox') {
              val = el.checked ? '1' : '0';
            }
          }
          // Remove param if it matches default (keeps URLs short/clean).
          if (_defaults.hasOwnProperty(key) && String(_defaults[key]) === String(val)) {
            params.delete(key);
          } else {
            params.set(key, String(val));
          }
          _replaceUrl(params);
        });
      });
    }

    function _applyTreeAndSnippetTogglesFromParams(params) {
      // Apply per-toggle URL keys (compact, SHA-first).
      try {
        // Tree nodes (triangles)
        var tris = document.querySelectorAll('[data-children-id][data-url-key]');
        tris.forEach(function(tg) {
          try {
            var urlKey = String(tg.getAttribute('data-url-key') || '');
            if (!urlKey || !params.has(urlKey)) return;
            var wantOpen = _isTruthyParam(params.get(urlKey));
            var cid = String(tg.getAttribute('data-children-id') || '');
            if (!cid) return;
            var el = document.getElementById(cid);
            if (!el) return;
            el.style.display = wantOpen ? 'inline' : 'none';
            tg.textContent = wantOpen ? '‚ñº' : '‚ñ∂';
          } catch (e) {}
        });

        // Snippets
        var snToggles = document.querySelectorAll('[data-error-id][data-url-key]');
        snToggles.forEach(function(tg) {
          try {
            var urlKey = String(tg.getAttribute('data-url-key') || '');
            if (!urlKey || !params.has(urlKey)) return;
            var wantOpen = _isTruthyParam(params.get(urlKey));
            var errId = String(tg.getAttribute('data-error-id') || '');
            if (!errId) return;
            var el = document.getElementById(errId);
            if (!el) return;
            el.style.display = wantOpen ? 'inline' : 'none';
            tg.textContent = wantOpen ? '‚ñº Hide snippet' : '‚ñ∂ Snippet';
          } catch (e) {}
        });
      } catch (e) {}
    }

    window.DashboardUrlState = {
      get: function(key) {
        try { return _parseParams().get(String(key || '')); } catch (e) { return null; }
      },
      has: function(key) {
        try { return _parseParams().has(String(key || '')); } catch (e) { return false; }
      },
      // Expose tree toggle application for use when switching between sort views
      _applyTreeToggles: function() {
        try {
          _applyTreeAndSnippetTogglesFromParams(_parseParams());
        } catch (e) {}
      },
      set: function(key, value) {
        if (_restoring) return;
        try {
          var k = String(key || '');
          if (!k) return;
          var params = _parseParams();
          params.set(k, String(value == null ? '' : value));
          _replaceUrl(params);
        } catch (e) {}
      },
      setBool: function(key, boolVal) {
        if (_restoring) return;
        try {
          var k = String(key || '');
          if (!k) return;
          var params = _parseParams();
          params.set(k, boolVal ? '1' : '0');
          _replaceUrl(params);
        } catch (e) {}
      },
      // Like setBool(), but remove the key from the URL when the value matches the default.
      // This keeps URLs short and avoids `...?x=0` noise.
      setBoolDefault: function(key, boolVal, defaultVal) {
        if (_restoring) return;
        try {
          var k = String(key || '');
          if (!k) return;
          var params = _parseParams();
          var v = !!boolVal;
          var d = !!defaultVal;
          if (v === d) {
            params.delete(k);
          } else {
            params.set(k, v ? '1' : '0');
          }
          _replaceUrl(params);
        } catch (e) {}
      },
      // Like set(), but remove the key from the URL when the value matches the default.
      // This keeps URLs short and avoids showing default values.
      setDefault: function(key, value, defaultVal) {
        if (_restoring) return;
        try {
          var k = String(key || '');
          if (!k) return;
          var params = _parseParams();
          var v = String(value == null ? '' : value);
          var d = String(defaultVal == null ? '' : defaultVal);
          if (v === d) {
            params.delete(k);
          } else {
            params.set(k, v);
          }
          _replaceUrl(params);
        } catch (e) {}
      },
      resetView: function(opts) {
        // Remove known dashboard-state query params and restore defaults.
        // Default behavior reloads the page after clearing URL so non-control state (e.g. default-expanded trees)
        // is also restored.
        try {
          var o = opts || {};
          var doReload = (o.reload !== false);
          var params = _parseParams();

          // Remove dashboard state params.
          var toDelete = [];
          params.forEach(function(v, k) {
            var ks = String(k || '');
            if (!ks) return;
            if (ks === 'legend') { toDelete.push(ks); return; }
            if (ks === 'date.mode') { toDelete.push(ks); return; }
            if (ks.startsWith('col.')) { toDelete.push(ks); return; }
            if (ks.startsWith('t.')) { toDelete.push(ks); return; }      // tree toggles
            if (ks.startsWith('s.')) { toDelete.push(ks); return; }      // snippet toggles
            if (ks.startsWith('d.')) { toDelete.push(ks); return; }      // commit-history docker rows
            if (ks.startsWith('gh.')) { toDelete.push(ks); return; }     // commit-history github tree
            if (ks.startsWith('gl.')) { toDelete.push(ks); return; }     // commit-history gitlab tree
          });
          toDelete.forEach(function(k) { try { params.delete(k); } catch (e) {} });

          // Also remove any known control keys we recorded defaults for.
          try {
            Object.keys(_defaults || {}).forEach(function(k) {
              try { params.delete(String(k || '')); } catch (e) {}
            });
          } catch (e) {}

          _replaceUrl(params);

          if (doReload) {
            try { window.location.reload(); } catch (e) {}
          } else {
            // Best-effort restore of known controls without reload.
            _restoring = true;
            try {
              var nodes = document.querySelectorAll('[data-url-state="1"]');
              nodes.forEach(function(el) {
                var key = _controlKey(el);
                if (!key || !_defaults.hasOwnProperty(key)) return;
                var dv = _defaults[key];
                if (el.tagName && el.tagName.toLowerCase() === 'details') {
                  el.open = _isTruthyParam(dv);
                  try { el.dispatchEvent(new Event('toggle')); } catch (e) {}
                  return;
                }
                if (el.tagName && el.tagName.toLowerCase() === 'select') {
                  el.value = String(dv || '');
                  try { el.dispatchEvent(new Event('change')); } catch (e) {}
                  return;
                }
                var t = (el.getAttribute('type') || '').toLowerCase();
                if (t === 'checkbox') {
                  el.checked = _isTruthyParam(dv);
                  try { el.dispatchEvent(new Event('change')); } catch (e) {}
                  return;
                }
              });

              // Restore tree toggles to their default expanded/collapsed state.
              // BUT: keep nodes expanded if they contain currently-visible error snippets.
              try {
                // First, find all visible snippets
                var visibleSnippets = new Set();
                document.querySelectorAll('span[id^="err_snip_"]:not([id$="__toggle"])').forEach(function(snip) {
                  if (snip.style.display !== 'none') {
                    // This snippet is visible, find its parent tree node
                    var parent = snip.parentElement;
                    while (parent) {
                      if (parent.id && parent.id.startsWith('tree_children_k_')) {
                        visibleSnippets.add(parent.id);
                      }
                      parent = parent.parentElement;
                    }
                  }
                });
                
                var triNodes = document.querySelectorAll('[data-children-id]');
                triNodes.forEach(function(tg) {
                  var cid = tg.getAttribute('data-children-id');
                  if (!cid) return;
                  var defExp = (tg.getAttribute('data-default-expanded') === '1');
                  var cont = document.getElementById(cid);
                  if (!cont) return;
                  
                  // If this container or any child has visible snippets, keep it expanded
                  var hasVisibleSnippet = visibleSnippets.has(cid);
                  var shouldExpand = defExp || hasVisibleSnippet;
                  
                  cont.style.display = shouldExpand ? 'inline' : 'none';
                  tg.textContent = shouldExpand ? '‚ñº' : '‚ñ∂';
                });
              } catch (e) {}

              // Restore snippets to default-collapsed, UNLESS they were manually expanded
              // (i.e., have a URL param that is '1').
              try {
                var snipToggles = document.querySelectorAll('[data-error-id][data-url-key]');
                snipToggles.forEach(function(tg) {
                  var urlKey = String(tg.getAttribute('data-url-key') || '');
                  var errId = String(tg.getAttribute('data-error-id') || '');
                  var el = document.getElementById(errId);
                  if (!urlKey || !el) return;

                  // If the snippet was explicitly expanded in the URL, keep it expanded.
                  // Otherwise, collapse it.
                  var wasExpandedInUrl = params.has(urlKey) && _isTruthyParam(params.get(urlKey));
                  if (wasExpandedInUrl) {
                    el.style.display = 'inline';
                    tg.textContent = '‚ñº Hide snippet';
                  } else {
                    el.style.display = 'none';
                    tg.textContent = '‚ñ∂ Snippet';
                  }
                });
              } catch (e) {}

              // Commit-history specific: collapse expanded rows (GitHub/GitLab trees + docker details).
              // These are not part of the <pre> tree renderer, so we must reset them explicitly.
              try {
                // Docker details rows
                document.querySelectorAll('tr[id^="docker-row-"]').forEach(function(tr) {
                  tr.style.display = 'none';
                });
                // GitHub tree rows
                document.querySelectorAll('tr[id^="github-tree-row-"]').forEach(function(tr) {
                  tr.style.display = 'none';
                });
                // GitLab tree rows
                document.querySelectorAll('tr[id^="gitlab-tree-row-"]').forEach(function(tr) {
                  tr.style.display = 'none';
                });
                // Reset the toggle glyphs
                document.querySelectorAll('[id^="docker-toggle-"]').forEach(function(el) { el.textContent = '‚ñ∂'; });
                document.querySelectorAll('[id^="github-tree-toggle-"]').forEach(function(el) { el.textContent = '‚ñ∂'; });
                document.querySelectorAll('[id^="gitlab-tree-toggle-"]').forEach(function(el) { el.textContent = '‚ñ∂'; });
              } catch (e) {}
            } finally {
              _restoring = false;
            }
            
            // Restore sort radio buttons AFTER _restoring is false so the change event can update URL/display.
            try {
              var sortRadios = document.querySelectorAll('input[name="tree-sort"]');
              if (sortRadios && sortRadios.length) {
                sortRadios.forEach(function(r) {
                  // Default is 'modified' (was 'latest' before)
                  r.checked = (String(r.value || '') === 'modified');
                });
                // Trigger change event to update the display
                var checkedRadio = Array.from(sortRadios).find(function(r) { return r.checked; });
                if (checkedRadio) {
                  try { checkedRadio.dispatchEvent(new Event('change')); } catch (e) {}
                }
              }
            } catch (e) {}
          }
        } catch (e) {}
      },
      init: function() {
        _captureDefaults();
        var params = _parseParams();
        _applyToControlsFromParams(params);
        _applyTreeAndSnippetTogglesFromParams(params);
        _bindControlsToUrl();
      }
    };

    // Simple ready-queue so dashboard-specific scripts can run AFTER DashboardUrlState.init()
    // without relying on DOMContentLoaded handler registration order.
    window.__dashboardReady = window.__dashboardReady || { fired: false };
    window.__dashboardOnReadyQueue = window.__dashboardOnReadyQueue || [];
    window.dashboardOnReady = function(cb) {
      try {
        if (window.__dashboardReady && window.__dashboardReady.fired) {
          cb();
        } else {
          window.__dashboardOnReadyQueue.push(cb);
        }
      } catch (e) {}
    };

    document.addEventListener('DOMContentLoaded', function() {
      try { window.DashboardUrlState.init(); } catch (e) {}
      try {
        window.__dashboardReady.fired = true;
        var q = window.__dashboardOnReadyQueue || [];
        window.__dashboardOnReadyQueue = [];
        q.forEach(function(fn) { try { fn(); } catch (e) {} });
      } catch (e) {}
    });

    // ====================================================================================
    // Sleep/wake fault-tolerant "reload only if new file" checker (replaces meta refresh)
    //
    // Requirement:
    // - Poll periodically (configurable per page; default 30 seconds).
    // - Only reload when the underlying HTML file changed on the server (ETag / Last-Modified).
    // - Tolerate sleep/wake + transient disconnects (keep page; retry).
    //
    // Note: dashboard URLs often include query/hash for view state; we intentionally probe the
    // *path* only (same file), then reload the full current URL to preserve view state.
    // ====================================================================================
    (function() {
      var checkIntervalMs = 15000;
      var retryMs = 2000;
      var maxRetryMs = 60000;
      var retryTimer = null;
      var scheduledTimer = null;
      var lastTick = Date.now();
      var lastPathname = String(window.location && window.location.pathname || "");
      var lastEtag = "";
      var lastLastModified = "";
      var lastContentLength = "";
      var hasBaseline = false;

      // Intentionally do NOT compare Last-Modified to generated_time on load.
      // That heuristic can cause reload loops when time parsing differs or clocks drift.

      function _ensureBanner() {
        var el = document.getElementById('auto-refresh-banner');
        if (el) return el;
        el = document.createElement('div');
        el.id = 'auto-refresh-banner';
        el.className = 'auto-refresh-banner';
        el.innerHTML = '<div class="msg" id="auto-refresh-banner-msg"></div>' +
                       '<div style="display:flex; gap:8px; align-items:center;">' +
                       '<button id="auto-refresh-banner-retry" type="button">Retry now</button>' +
                       '</div>';
        document.body.appendChild(el);
        var btn = document.getElementById('auto-refresh-banner-retry');
        if (btn) btn.addEventListener('click', function() { _attemptReloadSoon(0); });
        return el;
      }

      function _setBanner(msg) {
        try {
          var el = _ensureBanner();
          var msgEl = document.getElementById('auto-refresh-banner-msg');
          if (msgEl) msgEl.textContent = String(msg || '');
          el.style.display = 'inline-flex';
        } catch (e) {}
      }

      function _hideBanner() {
        try {
          var el = document.getElementById('auto-refresh-banner');
          if (el) el.style.display = 'none';
        } catch (e) {}
      }

      function _sleepAwareTick() {
        var now = Date.now();
        var delta = now - lastTick;
        lastTick = now;
        // If timers were paused (sleep), re-check quickly after wake.
        if (delta > 30000) {
          _attemptCheckSoon(250);
        }
      }

      function _buildProbeUrl() {
        try {
          // Probe the file at the current path (ignore query/hash which are UI state).
          var u = new URL(window.location.origin + window.location.pathname);
          u.searchParams.set('__probe', String(Date.now()));
          return u.toString();
        } catch (e) {
          return String(window.location.href || '');
        }
      }

      function _probeOnce() {
        var url = _buildProbeUrl();
        // Prefer HEAD (cheap), but fallback to GET if the server doesn't allow it.
        return fetch(url, { method: 'HEAD', cache: 'no-store', credentials: 'same-origin' })
          .then(function(resp) {
            if (resp && (resp.status === 405 || resp.status === 501)) {
              return fetch(url, { method: 'GET', cache: 'no-store', credentials: 'same-origin' })
                .then(function(r2) { return r2; })
                .catch(function() { return null; });
            }
            return resp;
          })
          .catch(function() { return null; });
      }

      function _attemptCheckSoon(ms) {
        try { if (retryTimer) window.clearTimeout(retryTimer); } catch (e) {}
        retryTimer = window.setTimeout(_attemptCheck, Math.max(0, Number(ms || 0)));
      }

      function _scheduleNextNormalCheck() {
        try { if (scheduledTimer) window.clearTimeout(scheduledTimer); } catch (e) {}
        scheduledTimer = window.setTimeout(function() { _attemptCheckSoon(0); }, checkIntervalMs);
      }

      function _attemptCheck() {
        // If the URL changed (SPA-style or manual), reset validators.
        try {
          var pn = String(window.location && window.location.pathname || "");
          if (pn && pn !== lastPathname) {
            lastPathname = pn;
            lastEtag = "";
            lastLastModified = "";
            lastContentLength = "";
          }
        } catch (e) {}

        // Don't churn hidden tabs; we'll refresh when visible again.
        if (document.hidden) {
          _scheduleNextNormalCheck();
          return;
        }
        // If we know we're offline, keep the page and retry.
        try {
          if (navigator && navigator.onLine === false) {
            _setBanner('Disconnected (offline). Keeping this page; retrying‚Ä¶');
            _scheduleNextNormalCheck();
            return;
          }
        } catch (e) {}

        _probeOnce().then(function(resp) {
          if (!(resp && resp.ok)) {
            _setBanner('Disconnected (server unreachable). Keeping this page; retrying‚Ä¶');
            _scheduleNextNormalCheck();
            return;
          }

          _hideBanner();
          retryMs = 2000;

          // Compare validators.
          var etag = '';
          var lm = '';
          var cl = '';
          try { etag = String(resp.headers.get('etag') || ''); } catch (e) { etag = ''; }
          try { lm = String(resp.headers.get('last-modified') || ''); } catch (e) { lm = ''; }
          try { cl = String(resp.headers.get('content-length') || ''); } catch (e) { cl = ''; }

          var changed = false;
          if (hasBaseline) {
            if (etag && lastEtag && etag !== lastEtag) changed = true;
            if (!changed && lm && lastLastModified && lm !== lastLastModified) changed = true;
            if (!changed && cl && lastContentLength && cl !== lastContentLength) changed = true;
          }

          // Update stored validators (even if empty, keep best-effort).
          if (etag) lastEtag = etag;
          if (lm) lastLastModified = lm;
          if (cl) lastContentLength = cl;
          hasBaseline = true;

          if (changed) {
            try { window.location.reload(); } catch (e) {}
            return;
          }
          _scheduleNextNormalCheck();
        });
      }

      // Start normal check loop.
      _scheduleNextNormalCheck();

      // Wake / connectivity helpers.
      window.setInterval(_sleepAwareTick, 5000);
      window.addEventListener('online', function() { _attemptCheckSoon(250); });
      document.addEventListener('visibilitychange', function() {
        if (!document.hidden) _attemptCheckSoon(250);
      });
    })();
  })();
  </script>

  
</body>
</html>

